
CREATE OR REPLACE VIEW APM3_SAP_USER.DT_APM3_PULP2_001_V("ID","TSTAMP","DCS_TAG","VALUE","UNIT","TAG_DESC")
AS
WITH DATA_TABLE AS
---- AUTHOR: ADHIR DUTTA
---- DATE: 2022-NOV-17
---- APM3 VIEW TABLE
(SELECT 
---- Temp Table with Formatted Data
    RINDEX,
    TO_CHAR(LDATE, 'YYYY-MM-DD HH24:MI:SS') AS LDATE,
    ROUND(APM30001,2)	AS 	C001,
    ROUND(APM30002,2)	AS 	C002,
    ROUND(APM30003,2)	AS 	C003,
    ROUND(APM30004,2)	AS 	C004,
    ROUND(APM30005,2)	AS 	C005,
    ROUND(APM30006,2)	AS 	C006,
    ROUND(APM30007,2)	AS 	C007,
    ROUND(APM30008,2)	AS 	C008,
    ROUND(APM30009,2)	AS 	C009,
    ROUND(APM30010,2)	AS 	C010,
    ROUND(APM30011,2)	AS 	C011,
    ROUND(APM30012,2)	AS 	C012,
    ROUND(APM30013,2)	AS 	C013,
    ROUND(APM30014,2)	AS 	C014,
    ROUND(APM30015,2)	AS 	C015,
    ROUND(APM30016,2)	AS 	C016,
    ROUND(APM30017,2)	AS 	C017,
    ROUND(APM30018,2)	AS 	C018,
    ROUND(APM30019,2)	AS 	C019,
    ROUND(APM30020,2)	AS 	C020,
    ROUND(APM30021,2)	AS 	C021,
    ROUND(APM30022,2)	AS 	C022,
    ROUND(APM30023,2)	AS 	C023,
    ROUND(APM30024,2)	AS 	C024,
    ROUND(APM30025,2)	AS 	C025,
    ROUND(APM30026,2)	AS 	C026,
    ROUND(APM30027,2)	AS 	C027,
    ROUND(APM30028,2)	AS 	C028,
    ROUND(APM30029,2)	AS 	C029,
    ROUND(APM30030,2)	AS 	C030,
    ROUND(APM30031,2)	AS 	C031,
    ROUND(APM30032,2)	AS 	C032,
    ROUND(APM30033,2)	AS 	C033,
    ROUND(APM30034,2)	AS 	C034,
    ROUND(APM30035,2)	AS 	C035,
    ROUND(APM30036,2)	AS 	C036,
    ROUND(APM30037,2)	AS 	C037,
    ROUND(APM30038,2)	AS 	C038,
    ROUND(APM30039,2)	AS 	C039,
    ROUND(APM30040,2)	AS 	C040,
    ROUND(APM30041,2)	AS 	C041,
    ROUND(APM30042,2)	AS 	C042,
    ROUND(APM30043,2)	AS 	C043,
    ROUND(APM30044,2)	AS 	C044,
    ROUND(APM30045,2)	AS 	C045,
    ROUND(APM30046,2)	AS 	C046,
    ROUND(APM30047,2)	AS 	C047,
    ROUND(APM30048,2)	AS 	C048,
    ROUND(APM30049,2)	AS 	C049,
    ROUND(APM30050,2)	AS 	C050,
    ROUND(APM30051,2)	AS 	C051,
    ROUND(APM30052,2)	AS 	C052,
    ROUND(APM30053,2)	AS 	C053,
    ROUND(APM30054,2)	AS 	C054,
    ROUND(APM30055,2)	AS 	C055,
    ROUND(APM30056,2)	AS 	C056,
    ROUND(APM30057,2)	AS 	C057,
    ROUND(APM30058,2)	AS 	C058,
    ROUND(APM30059,2)	AS 	C059,
    ROUND(APM30060,2)	AS 	C060,
    ROUND(APM30061,2)	AS 	C061,
    ROUND(APM30062,2)	AS 	C062,
    ROUND(APM30063,2)	AS 	C063,
    ROUND(APM30064,2)	AS 	C064,
    ROUND(APM30065,2)	AS 	C065,
    ROUND(APM30066,2)	AS 	C066,
    ROUND(APM30067,2)	AS 	C067
FROM ABBSG.DT_APM3_PULP2_001 WHERE RINDEX>=(SELECT MAX(RINDEX) FROM ABBSG.DT_APM3_PULP2_001))
SELECT
---- ADD DATA AS COLUMN WITH META TABLE
    B.ID,
    A.LDATE AS TSTAMP,
    B.DCS_TAG,
    CASE(B.COLID)
    WHEN 'C001' THEN	A.C001
    WHEN 'C002' THEN	A.C002
    WHEN 'C003' THEN	A.C003
    WHEN 'C004' THEN	A.C004
    WHEN 'C005' THEN	A.C005
    WHEN 'C006' THEN	A.C006
    WHEN 'C007' THEN	A.C007
    WHEN 'C008' THEN	A.C008
    WHEN 'C009' THEN	A.C009
    WHEN 'C010' THEN	A.C010
    WHEN 'C011' THEN	A.C011
    WHEN 'C012' THEN	A.C012
    WHEN 'C013' THEN	A.C013
    WHEN 'C014' THEN	A.C014
    WHEN 'C015' THEN	A.C015
    WHEN 'C016' THEN	A.C016
    WHEN 'C017' THEN	A.C017
    WHEN 'C018' THEN	A.C018
    WHEN 'C019' THEN	A.C019
    WHEN 'C020' THEN	A.C020
    WHEN 'C021' THEN	A.C021
    WHEN 'C022' THEN	A.C022
    WHEN 'C023' THEN	A.C023
    WHEN 'C024' THEN	A.C024
    WHEN 'C025' THEN	A.C025
    WHEN 'C026' THEN	A.C026
    WHEN 'C027' THEN	A.C027
    WHEN 'C028' THEN	A.C028
    WHEN 'C029' THEN	A.C029
    WHEN 'C030' THEN	A.C030
    WHEN 'C031' THEN	A.C031
    WHEN 'C032' THEN	A.C032
    WHEN 'C033' THEN	A.C033
    WHEN 'C034' THEN	A.C034
    WHEN 'C035' THEN	A.C035
    WHEN 'C036' THEN	A.C036
    WHEN 'C037' THEN	A.C037
    WHEN 'C038' THEN	A.C038
    WHEN 'C039' THEN	A.C039
    WHEN 'C040' THEN	A.C040
    WHEN 'C041' THEN	A.C041
    WHEN 'C042' THEN	A.C042
    WHEN 'C043' THEN	A.C043
    WHEN 'C044' THEN	A.C044
    WHEN 'C045' THEN	A.C045
    WHEN 'C046' THEN	A.C046
    WHEN 'C047' THEN	A.C047
    WHEN 'C048' THEN	A.C048
    WHEN 'C049' THEN	A.C049
    WHEN 'C050' THEN	A.C050
    WHEN 'C051' THEN	A.C051
    WHEN 'C052' THEN	A.C052
    WHEN 'C053' THEN	A.C053
    WHEN 'C054' THEN	A.C054
    WHEN 'C055' THEN	A.C055
    WHEN 'C056' THEN	A.C056
    WHEN 'C057' THEN	A.C057
    WHEN 'C058' THEN	A.C058
    WHEN 'C059' THEN	A.C059
    WHEN 'C060' THEN	A.C060
    WHEN 'C061' THEN	A.C061
    WHEN 'C062' THEN	A.C062
    WHEN 'C063' THEN	A.C063
    WHEN 'C064' THEN	A.C064
    WHEN 'C065' THEN	A.C065
    WHEN 'C066' THEN	A.C066
    WHEN 'C067' THEN	A.C067
    END AS VALUE,
    B.UNIT,
    B.TAG_DESC
FROM
(SELECT * FROM DATA_TABLE) A,
(SELECT ID, COLID ,DCS_TAG ,TAG_DESC ,UNIT  FROM APM3_SAP_USER.META_DT_APM3_PULP2_001) B; 
